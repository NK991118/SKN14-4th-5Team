{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>논술 문항 선택</title>
    <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <script
    src="{% static 'js/schools.json' %}"
    type="application/json"
    id="json-data"
    ></script>
</head>
<body class="p-4">
    <div class="container">
    <h2 class="mb-4">논술 문항 선택</h2>
    <div class="row g-3">
        <div class="col-md-4">
        <label for="schoolSelect" class="form-label">학교 선택</label>
        <select id="schoolSelect" class="form-select">
            <option selected disabled>학교를 선택하세요</option>
        </select>
        </div>
        <div class="col-md-4">
        <label for="yearSelect" class="form-label">연도 선택</label>
        <select id="yearSelect" class="form-select" disabled>
            <option selected disabled>연도를 선택하세요</option>
        </select>
        </div>
        <div class="col-md-4">
        <label for="questionSelect" class="form-label">문항 선택</label>
        <select id="questionSelect" class="form-select" disabled>
            <option selected disabled>문항을 선택하세요</option>
        </select>
        </div>
    </div>
    <div id="pdfContainer" class="mb-4" style="display: none">
        <h5>문제 PDF 미리보기</h5>
        <iframe
        src="/static/pdf/ewha_2024_1.pdf"
        width="100%"
        height="600px"
        style="border: 1px solid #ccc"
        ></iframe>
        <iframe
        id="pdfViewer"
        width="100%"
        height="500px"
        style="border: 1px solid #ccc"
        ></iframe>
    </div>

    <div class="mb-4">
        <h5>타이머</h5>
        <div class="d-flex align-items-center gap-3">
        <span id="timerDisplay" class="fs-4">00:00:00</span>
        <button class="btn btn-success" onclick="startTimer()">시작</button>
        <button class="btn btn-warning" onclick="pauseTimer()">
            일시정지
        </button>
        <button class="btn btn-danger" onclick="resetTimer()">초기화</button>
        </div>
    </div>
    <script src="{% static 'js/schools.js' %}"></script>
    <script>
        // 타이머
        let timer;
        let seconds = 0;
        let isRunning = false;

        function updateDisplay() {
        const hrs = String(Math.floor(seconds / 3600)).padStart(2, "0");
        const mins = String(Math.floor((seconds % 3600) / 60)).padStart(
            2,
            "0"
        );
        const secs = String(seconds % 60).padStart(2, "0");
        document.getElementById(
            "timerDisplay"
        ).textContent = `${hrs}:${mins}:${secs}`;
        }

        function startTimer() {
        if (isRunning) return;
        isRunning = true;
        timer = setInterval(() => {
            seconds++;
            updateDisplay();
        }, 1000);
        }

        function pauseTimer() {
        clearInterval(timer);
        isRunning = false;
        }

        function resetTimer() {
        clearInterval(timer);
        isRunning = false;
        seconds = 0;
        updateDisplay();
        }

        // 문항 선택 시 PDF 보여주기 + 타이머 시작
        document
        .getElementById("questionSelect")
        .addEventListener("change", function () {
            const selectedPdf = this.value; // value에 PDF 경로가 있어야 함
            const pdfPath = `/static/pdf/${selectedPdf}`; // 예시 경로
            document.getElementById("pdfViewer").src = pdfPath;
            document.getElementById("pdfContainer").style.display = "block";
            resetTimer(); // 새 문제 선택 시 초기화
            startTimer(); // 타이머 시작
        });
    </script>
    </div>

    <script src="{% static 'js/schools.js' %}"></script>
</body>
</html>
